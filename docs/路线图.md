# Roadmap / 路线图

**Project / 项目:** Conversation Kit Demo  
**Version / 版本:** 1.0  
**Last Updated / 最后更新:** 2026-02-28  

---

## 1. Current Status / 当前状态

### 1.1 Implemented Features / 已实现功能

| Feature / 功能 | Status / 状态 | Completion / 完成度 |
|---------------|--------------|-------------------|
| Message display with Markdown / 带 Markdown 的消息显示 | ✅ Complete / 完成 | 100% |
| Streaming output simulation / 流式输出模拟 | ✅ Complete / 完成 | 100% |
| Heading detection and extraction / 标题检测和提取 | ✅ Complete / 完成 | 100% |
| Tree view navigation / 树形视图导航 | ✅ Complete / 完成 | 90% |
| Resizable sidebar / 可调整侧边栏 | ✅ Complete / 完成 | 100% |
| Sidebar position toggle / 侧边栏位置切换 | ✅ Complete / 完成 | 100% |

### 1.2 Partially Implemented / 部分实现

| Feature / 功能 | Status / 状态 | Issues / 问题 |
|---------------|--------------|--------------|
| Anchor navigation / 锚点导航 | ⚠️ Partial / 部分 | Message-level works, heading-level pending / 消息级别可用，标题级别待完成 |
| Full-text search / 全文搜索 | ⚠️ Partial / 部分 | UI complete, logic has bugs / UI 完成，逻辑有缺陷 |

---

## 2. Phase 1: Bug Fixes / 第一阶段：缺陷修复

**Timeline / 时间线:** Immediate / 立即  
**Priority / 优先级:** High / 高  

### 2.1 Search Functionality Fix / 搜索功能修复

**Problem / 问题:**
Search returns no results even when matches exist in content.
/ 即使内容中存在匹配项，搜索仍返回无结果。

**Root Cause Analysis / 根本原因分析:**
- Pinia store state may not be properly shared between components
- Pinia 存储状态可能在组件间未正确共享
- Search query transformation may have encoding issues
- 搜索查询转换可能存在编码问题

**Solution Approach / 解决方案:**
1. Debug store state sharing / 调试存储状态共享
2. Verify search algorithm execution / 验证搜索算法执行
3. Add console logging for troubleshooting / 添加控制台日志用于故障排除
4. Consider using provide/inject for search state / 考虑使用 provide/inject 进行搜索状态管理

**Acceptance Criteria / 验收标准:**
- Search "Processing" returns results when content contains "Processing"
- 当内容包含 "Processing" 时，搜索 "Processing" 返回结果
- Search "响应式" returns results for Chinese content
- 搜索 "响应式" 返回中文内容结果
- Results display with highlighted terms
- 结果显示带高亮词

**Reference / 引用:** [SRS FR-007](./需求规约说明书.md#37-fr-007-full-text-search--全文搜索)

### 2.2 Subheading Navigation Fix / 子标题导航修复

**Problem / 问题:**
Clicking subheadings in tree view selects the node but doesn't scroll to the heading position.
/ 点击树视图中的子标题会选中节点，但不滚动到标题位置。

**Root Cause Analysis / 根本原因分析:**
- Anchor ID format mismatch between tree and rendered content
- 树和渲染内容之间的锚点 ID 格式不匹配
- Scroll logic may not handle nested anchors
- 滚动逻辑可能未处理嵌套锚点

**Solution Approach / 解决方案:**
1. Verify anchor ID generation in MarkdownRenderer
- 验证 MarkdownRenderer 中的锚点 ID 生成
2. Ensure tree node anchorId matches rendered heading anchorId
- 确保树节点 anchorId 与渲染标题 anchorId 匹配
3. Test scrollToAnchor with various heading levels
- 使用各种标题级别测试 scrollToAnchor

**Acceptance Criteria / 验收标准:**
- Clicking "#2 Steps" in tree scrolls to Steps heading in message
- 点击树中的 "#2 Steps" 滚动到消息中的 Steps 标题
- Active highlight syncs between tree and message
- 树和消息之间的激活高亮同步

**Reference / 引用:** [SRS FR-006](./需求规约说明书.md#36-fr-006-anchor-navigation--锚点导航)

---

## 3. Phase 2: Feature Enhancement / 第二阶段：功能增强

**Timeline / 时间线:** Short-term (1-2 weeks) / 短期（1-2周）  
**Priority / 优先级:** Medium / 中  

### 3.1 Real-time Collaboration / 实时协作

**Description / 描述:**
Support multiple users viewing and interacting with the same conversation.
/ 支持多个用户查看和交互同一对话。

**Technical Approach / 技术方案:**
- WebSocket for real-time updates / WebSocket 用于实时更新
- Operational Transformation for concurrent edits / 操作转换用于并发编辑
- User presence indicators / 用户在线指示器

**Dependencies / 依赖:**
- Backend WebSocket server / 后端 WebSocket 服务器
- User authentication system / 用户认证系统

### 3.2 Message Persistence / 消息持久化

**Description / 描述:**
Save and load conversation history from storage.
/ 从存储中保存和加载对话历史。

**Technical Approach / 技术方案:**
- LocalStorage for client-side persistence / LocalStorage 用于客户端持久化
- Optional backend API integration / 可选后端 API 集成
- Export/import as JSON / 导出/导入为 JSON

**Acceptance Criteria / 验收标准:**
- Conversations persist across page reloads
- 对话在页面重载后保持
- Export conversation to file
- 导出对话到文件
- Import conversation from file
- 从文件导入对话

### 3.3 Enhanced Markdown Support / 增强 Markdown 支持

**Description / 描述:**
Extend Markdown parser to support more syntax elements.
/ 扩展 Markdown 解析器以支持更多语法元素。

**Planned Additions / 计划添加:**
- Tables / 表格
- Blockquotes / 引用块
- Horizontal rules / 水平分隔线
- Task lists / 任务列表
- Strikethrough / 删除线

**Technical Approach / 技术方案:**
- Integrate marked.js or similar library
- 集成 marked.js 或类似库
- Custom renderer for anchor injection
- 用于锚点注入的自定义渲染器

---

## 4. Phase 3: Advanced Features / 第三阶段：高级功能

**Timeline / 时间线:** Medium-term (1-2 months) / 中期（1-2月）  
**Priority / 优先级:** Low / 低  

### 4.1 Plugin System / 插件系统

**Description / 描述:**
Allow third-party extensions to customize functionality.
/ 允许第三方扩展自定义功能。

**Plugin Types / 插件类型:**
- Custom renderers / 自定义渲染器
- Message transformers / 消息转换器
- UI components / UI 组件
- External service integrations / 外部服务集成

**API Design / API 设计:**
```typescript
interface ConversationKitPlugin {
  name: string
  install: (context: PluginContext) => void
}
```

### 4.2 AI Integration / AI 集成

**Description / 描述:**
Connect to real AI services instead of simulated responses.
/ 连接到真实 AI 服务而非模拟响应。

**Supported Providers / 支持的提供商:**
- OpenAI GPT / OpenAI GPT
- Anthropic Claude / Anthropic Claude
- Google Gemini / Google Gemini
- Local models via Ollama / 通过 Ollama 的本地模型

**Configuration / 配置:**
```typescript
interface AIConfig {
  provider: 'openai' | 'anthropic' | 'google' | 'ollama'
  apiKey: string
  model: string
  temperature?: number
}
```

### 4.3 Voice Input/Output / 语音输入/输出

**Description / 描述:**
Support speech-to-text input and text-to-speech output.
/ 支持语音转文本输入和文本转语音输出。

**Technologies / 技术:**
- Web Speech API / Web 语音 API
- Azure Speech Services / Azure 语音服务
- Amazon Polly / Amazon Polly

---

## 5. Technical Debt / 技术债务

### 5.1 Code Quality Improvements / 代码质量改进

| Item / 项 | Priority / 优先级 | Effort / 工作量 |
|----------|------------------|----------------|
| Add unit tests / 添加单元测试 | High / 高 | 2-3 days / 2-3 天 |
| Add E2E tests / 添加 E2E 测试 | High / 高 | 2-3 days / 2-3 天 |
| Improve TypeScript coverage / 改进 TypeScript 覆盖 | Medium / 中 | 1-2 days / 1-2 天 |
| Extract magic numbers to constants / 提取魔法数字为常量 | Low / 低 | 1 day / 1 天 |

### 5.2 Performance Optimization / 性能优化

| Item / 项 | Current / 当前 | Target / 目标 |
|----------|---------------|--------------|
| Bundle size / 包大小 | ~85KB | < 50KB |
| First paint / 首次绘制 | ~200ms | < 100ms |
| Message render (100 msgs) / 消息渲染（100条） | ~50ms | < 30ms |

---

## 6. Cross-References / 交叉引用

| Roadmap Item / 路线图项 | SRS / 需求规约 | SDD / 详细设计 | Test / 测试 |
|------------------------|---------------|---------------|------------|
| Search Fix / 搜索修复 | [FR-007](./需求规约说明书.md#37-fr-007-full-text-search--全文搜索) | [SDD 2.6](./详细设计说明书.md#26-sdd-006-searchtab-component--搜索标签页组件) | [TC-007](./测试报告.md#tc-007) |
| Navigation Fix / 导航修复 | [FR-006](./需求规约说明书.md#36-fr-006-anchor-navigation--锚点导航) | [SDD 2.5](./详细设计说明书.md#25-sdd-005-treetab-component--树形标签页组件) | [TC-006](./测试报告.md#tc-006) |
| Persistence / 持久化 | New / 新增 | TBD / 待定 | TBD / 待定 |
| AI Integration / AI 集成 | New / 新增 | TBD / 待定 | TBD / 待定 |

---

## 7. Milestones / 里程碑

```
Week 1-2 / 第1-2周
├── Bug fixes (Search, Navigation) / 缺陷修复（搜索、导航）
└── Unit test setup / 单元测试设置

Week 3-4 / 第3-4周
├── Feature enhancement Phase 1 / 功能增强第一阶段
│   ├── Message persistence / 消息持久化
│   └── Enhanced Markdown / 增强 Markdown
└── Performance optimization / 性能优化

Month 2-3 / 第2-3月
├── Feature enhancement Phase 2 / 功能增强第二阶段
│   ├── Real-time collaboration / 实时协作
│   └── Plugin system foundation / 插件系统基础
└── Documentation updates / 文档更新

Month 4+ / 第4月+
├── Advanced features / 高级功能
│   ├── AI integration / AI 集成
│   └── Voice support / 语音支持
└── Community feedback integration / 社区反馈集成
```

---

## 8. Change History / 变更历史

| Date / 日期 | Version / 版本 | Changes / 变更 | Author / 作者 |
|-------------|----------------|----------------|---------------|
| 2026-02-28 | 1.0 | Initial roadmap / 初始路线图 | Development Team / 开发团队 |
